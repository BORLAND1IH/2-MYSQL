--
-- Script was generated by Devart dbForge Studio for MySQL, Version 10.1.24.0
-- Product home page: https://www.devart.com/dbforge/mysql/studio
-- Script date 25.12.2024 4:18:36
-- Server version: 5.5.25
--

--
-- Disable foreign keys
--
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;

--
-- Set SQL mode
--
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;

--
-- Set character set the client will use to send SQL statements to the server
--
SET NAMES 'utf8';

--
-- Set default database
--
USE pr14ih;

--
-- Drop table `оператор`
--
DROP TABLE IF EXISTS оператор;

--
-- Drop table `ведомость_абонентской_платы`
--
DROP TABLE IF EXISTS ведомость_абонентской_платы;

--
-- Drop table `ведомость_звонков`
--
DROP TABLE IF EXISTS ведомость_звонков;

--
-- Drop table `абонент`
--
DROP TABLE IF EXISTS абонент;

--
-- Drop table `льгота`
--
DROP TABLE IF EXISTS льгота;

--
-- Drop table `район`
--
DROP TABLE IF EXISTS район;

--
-- Drop table `статус_абонента`
--
DROP TABLE IF EXISTS статус_абонента;

--
-- Drop table `тип_телефона`
--
DROP TABLE IF EXISTS тип_телефона;

--
-- Drop table `прайс_атс`
--
DROP TABLE IF EXISTS прайс_атс;

--
-- Drop table `атс`
--
DROP TABLE IF EXISTS атс;

--
-- Drop table `город`
--
DROP TABLE IF EXISTS город;

--
-- Set default database
--
USE pr14ih;

--
-- Create table `город`
--
CREATE TABLE город (
  city_id int(11) NOT NULL AUTO_INCREMENT,
  city_name varchar(191) NOT NULL,
  PRIMARY KEY (city_id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb3,
COLLATE utf8mb3_general_ci,
ROW_FORMAT = COMPACT;

--
-- Create index `city_name` on table `город`
--
ALTER TABLE город
ADD UNIQUE INDEX city_name (city_name);

--
-- Create table `атс`
--
CREATE TABLE атс (
  `Название АТС` varchar(191) NOT NULL,
  Вид varchar(191) DEFAULT NULL,
  Адрес varchar(191) DEFAULT NULL,
  Город varchar(191) DEFAULT NULL,
  `Кол-во абонентов` int(11) DEFAULT NULL,
  city_id int(11) DEFAULT NULL,
  PRIMARY KEY (`Название АТС`)
)
ENGINE = INNODB,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb3,
COLLATE utf8mb3_general_ci,
ROW_FORMAT = COMPACT;

--
-- Create foreign key
--
ALTER TABLE атс
ADD CONSTRAINT FK_атс_city FOREIGN KEY (city_id)
REFERENCES город (city_id) ON DELETE NO ACTION;

--
-- Create table `прайс_атс`
--
CREATE TABLE прайс_атс (
  `ID прайса` int(11) NOT NULL AUTO_INCREMENT,
  `Название АТС` varchar(191) DEFAULT NULL,
  `Цена на городские` decimal(10, 2) DEFAULT NULL,
  `Цена на межгород` decimal(10, 2) DEFAULT NULL,
  date_start date NOT NULL,
  date_end date DEFAULT NULL,
  PRIMARY KEY (`ID прайса`)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb3,
COLLATE utf8mb3_general_ci,
ROW_FORMAT = COMPACT;

--
-- Create foreign key
--
ALTER TABLE прайс_атс
ADD CONSTRAINT FK_прайс_атс_название_атс FOREIGN KEY (`Название АТС`)
REFERENCES атс (`Название АТС`) ON DELETE NO ACTION;

--
-- Create table `тип_телефона`
--
CREATE TABLE тип_телефона (
  phone_type_id int(11) NOT NULL AUTO_INCREMENT,
  phone_type_name varchar(191) NOT NULL,
  PRIMARY KEY (phone_type_id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb3,
COLLATE utf8mb3_general_ci,
ROW_FORMAT = COMPACT;

--
-- Create index `phone_type_name` on table `тип_телефона`
--
ALTER TABLE тип_телефона
ADD UNIQUE INDEX phone_type_name (phone_type_name);

--
-- Create table `статус_абонента`
--
CREATE TABLE статус_абонента (
  abonent_status_id int(11) NOT NULL AUTO_INCREMENT,
  abonent_status_name varchar(191) NOT NULL,
  PRIMARY KEY (abonent_status_id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb3,
COLLATE utf8mb3_general_ci,
ROW_FORMAT = COMPACT;

--
-- Create index `abonent_status_name` on table `статус_абонента`
--
ALTER TABLE статус_абонента
ADD UNIQUE INDEX abonent_status_name (abonent_status_name);

--
-- Create table `район`
--
CREATE TABLE район (
  district_id int(11) NOT NULL AUTO_INCREMENT,
  district_name varchar(191) NOT NULL,
  PRIMARY KEY (district_id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb3,
COLLATE utf8mb3_general_ci,
ROW_FORMAT = COMPACT;

--
-- Create index `district_name` on table `район`
--
ALTER TABLE район
ADD UNIQUE INDEX district_name (district_name);

--
-- Create table `льгота`
--
CREATE TABLE льгота (
  benefit_id int(11) NOT NULL AUTO_INCREMENT,
  benefit_name varchar(191) NOT NULL,
  benefit_percent decimal(5, 2) DEFAULT NULL,
  PRIMARY KEY (benefit_id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb3,
COLLATE utf8mb3_general_ci,
ROW_FORMAT = COMPACT;

--
-- Create index `benefit_name` on table `льгота`
--
ALTER TABLE льгота
ADD UNIQUE INDEX benefit_name (benefit_name);

--
-- Create table `абонент`
--
CREATE TABLE абонент (
  `Номер телефона` varchar(191) NOT NULL,
  Фамилия varchar(191) DEFAULT NULL,
  Имя varchar(191) DEFAULT NULL,
  Отчество varchar(191) DEFAULT NULL,
  `Вид телефона` varchar(191) DEFAULT NULL,
  Межгород tinyint(1) DEFAULT NULL,
  Льгота tinyint(1) DEFAULT NULL,
  Индекс varchar(191) DEFAULT NULL,
  Район varchar(191) DEFAULT NULL,
  Улица varchar(191) DEFAULT NULL,
  Дом varchar(191) DEFAULT NULL,
  Квартира varchar(191) DEFAULT NULL,
  `Название АТС` varchar(191) DEFAULT NULL,
  phone_type_id int(11) DEFAULT NULL,
  benefit_id int(11) DEFAULT NULL,
  district_id int(11) DEFAULT NULL,
  abonent_status_id int(11) DEFAULT NULL,
  PRIMARY KEY (`Номер телефона`)
)
ENGINE = INNODB,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb3,
COLLATE utf8mb3_general_ci,
ROW_FORMAT = COMPACT;

--
-- Create foreign key
--
ALTER TABLE абонент
ADD CONSTRAINT FK_абонент_benefit FOREIGN KEY (benefit_id)
REFERENCES льгота (benefit_id) ON DELETE NO ACTION;

--
-- Create foreign key
--
ALTER TABLE абонент
ADD CONSTRAINT FK_абонент_district FOREIGN KEY (district_id)
REFERENCES район (district_id) ON DELETE NO ACTION;

--
-- Create foreign key
--
ALTER TABLE абонент
ADD CONSTRAINT FK_абонент_название_атс FOREIGN KEY (`Название АТС`)
REFERENCES атс (`Название АТС`) ON DELETE NO ACTION;

--
-- Create foreign key
--
ALTER TABLE абонент
ADD CONSTRAINT FK_абонент_phone_type FOREIGN KEY (phone_type_id)
REFERENCES тип_телефона (phone_type_id) ON DELETE NO ACTION;

--
-- Create foreign key
--
ALTER TABLE абонент
ADD CONSTRAINT FK_абонент_status FOREIGN KEY (abonent_status_id)
REFERENCES статус_абонента (abonent_status_id) ON DELETE NO ACTION;

--
-- Create table `ведомость_звонков`
--
CREATE TABLE ведомость_звонков (
  `ID звонка` int(11) NOT NULL AUTO_INCREMENT,
  `Номер телефона` varchar(191) DEFAULT NULL,
  `Дата звонка` date DEFAULT NULL,
  `Время начала` time DEFAULT NULL,
  `Время окончания` time DEFAULT NULL,
  Межгород tinyint(1) DEFAULT NULL,
  PRIMARY KEY (`ID звонка`)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb3,
COLLATE utf8mb3_general_ci,
ROW_FORMAT = COMPACT;

--
-- Create foreign key
--
ALTER TABLE ведомость_звонков
ADD CONSTRAINT FK_ведомость_звонков_номер_телефона FOREIGN KEY (`Номер телефона`)
REFERENCES абонент (`Номер телефона`) ON DELETE NO ACTION;

--
-- Create table `ведомость_абонентской_платы`
--
CREATE TABLE ведомость_абонентской_платы (
  `ID записи` int(11) NOT NULL AUTO_INCREMENT,
  `Номер телефона` varchar(191) DEFAULT NULL,
  Месяц int(11) DEFAULT NULL,
  Год int(11) DEFAULT NULL,
  `Кол-во минут на городские` int(11) DEFAULT NULL,
  `Кол-во минут на межгород` int(11) DEFAULT NULL,
  Стоимость decimal(10, 2) DEFAULT NULL,
  `Сумма льготы` decimal(10, 2) DEFAULT NULL,
  `Общая стоимость` decimal(10, 2) DEFAULT NULL,
  PRIMARY KEY (`ID записи`)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb3,
COLLATE utf8mb3_general_ci,
ROW_FORMAT = COMPACT;

--
-- Create foreign key
--
ALTER TABLE ведомость_абонентской_платы
ADD CONSTRAINT FK_ведомость_абонентской_платы_номер_телефона FOREIGN KEY (`Номер телефона`)
REFERENCES абонент (`Номер телефона`) ON DELETE NO ACTION;

--
-- Create table `оператор`
--
CREATE TABLE оператор (
  operator_id int(11) NOT NULL AUTO_INCREMENT,
  operator_name varchar(191) NOT NULL,
  operator_login varchar(191) NOT NULL,
  operator_password varchar(191) NOT NULL,
  PRIMARY KEY (operator_id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb3,
COLLATE utf8mb3_general_ci,
ROW_FORMAT = COMPACT;

--
-- Create index `operator_login` on table `оператор`
--
ALTER TABLE оператор
ADD UNIQUE INDEX operator_login (operator_login);

-- 
-- Dumping data for table город
--
INSERT INTO город VALUES
(1, 'Москва'),
(2, 'Санкт-Петербург');

-- 
-- Dumping data for table тип_телефона
--
INSERT INTO тип_телефона VALUES
(2, 'Домашний'),
(1, 'Мобильный');

-- 
-- Dumping data for table статус_абонента
--
INSERT INTO статус_абонента VALUES
(1, 'Активен'),
(2, 'Неактивен');

-- 
-- Dumping data for table район
--
INSERT INTO район VALUES
(1, 'Центр'),
(2, 'Южный');

-- 
-- Dumping data for table льгота
--
INSERT INTO льгота VALUES
(1, 'Скидка на пенсионеров', 20.00),
(2, 'Скидка на многодетные семьи', 15.00);

-- 
-- Dumping data for table атс
--
INSERT INTO атс VALUES
('МГТС', 'Городская', 'ул. Тверская, 1', NULL, 50000, 1),
('СпбТТС', 'Междугородняя', 'ул. Невский, 15', NULL, 30000, 2);

-- 
-- Dumping data for table абонент
--
INSERT INTO абонент VALUES
('88005553535', 'Иванов', 'Иван', 'Иванович', 'Мобильный', 1, 0, '123456', 'Центр', 'ул. Пушкина', '10', '25', 'МГТС', 1, 1, 1, 1),
('88005553536', 'Петров', 'Сергей', 'Петрович', 'Домашний', 0, 1, '654321', 'Южный', 'ул. Ленина', '5', '10', 'СпбТТС', 2, 2, 2, 2);

-- 
-- Dumping data for table прайс_атс
--
INSERT INTO прайс_атс VALUES
(1, 'МГТС', 2.50, 5.00, '2024-01-01', NULL),
(2, 'СпбТТС', 2.00, 4.50, '2024-01-01', NULL);

-- 
-- Dumping data for table оператор
--
INSERT INTO оператор VALUES
(1, 'Иванов Иван', 'ivanov', 'password123'),
(2, 'Петров Сергей', 'petrov', 'password456');

-- 
-- Dumping data for table ведомость_звонков
--
INSERT INTO ведомость_звонков VALUES
(1, '88005553535', '2024-12-01', '12:00:00', '12:05:00', 1),
(2, '88005553536', '2024-12-02', '14:00:00', '14:10:00', 0);

-- 
-- Dumping data for table ведомость_абонентской_платы
--
INSERT INTO ведомость_абонентской_платы VALUES
(1, '88005553535', 12, 2024, 100, 50, 200.00, 50.00, 150.00),
(2, '88005553536', 12, 2024, 120, 40, 180.00, 30.00, 150.00);

--
-- Restore previous SQL mode
--
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;

--
-- Enable foreign keys
--
/*!40014 SET FOREIGN_KEY_CHECKS = @OLD_FOREIGN_KEY_CHECKS */;